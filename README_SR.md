# Поређење изабраних стратегија парчања текста у RAG системима

Оквир за евалуацију различитих стратегија парчања текста за системе генерисања потпомогнуте претрагом (RAG).

## Брзи почетак

1. Подешавање окружења:
   ```bash
   python3 -m venv .venv
   source .venv/bin/activate  # На macOS/Linux
   pip install -r master/requirements.txt
   ```

2. Подешавање OpenAI API кључа (потребно за евалуацију):
   ```bash
   # На macOS/Linux
   export OPENAI_API_KEY=ваш_api_кључ_овде
   
   # На Windows
   set OPENAI_API_KEY=ваш_api_кључ_овде
   
   # Или креирајте .env фајл у корену пројекта
   echo "OPENAI_API_KEY=ваш_api_кључ_овде" > .env
   ```

3. Покрените процес:
   ```bash
   python main/process_qasper.py
   python main/main-rag_processor.py
   python main/main-pipeline.py
   ```

## Функционалности

- Вишеструке стратегије парчања текста (Рекурзивно, Семантичко кластеровање, Парчање засновано на семантичкој сличности реченица, Хијерархијско)
- Метрике евалуације (Прецизност@k, Одзив@k, F1@k, MRR@k, LLM судија)
- Генерисање одговора помоћу LLM-а
- ChromaDB за складиштење векторских репрезентација података
- Интерактивни кориснички интерфејс за поређење стратегија парчања текста

## Покретање интерактивног корисничког интерфејса

За покретање интерактивног интерфејса за поређење:

1. Уверите се да сте инсталирали све потребне пакете:
   ```bash
   pip install streamlit
   pip install -r master/requirements.txt
   ```

2. Проверите да имате ChromaDB фајлове базе података у директоријуму `data/chroma_db`. Они се генеришу када покренете процес као што је описано у одељку Брзи почетак.

3. Подесите ваше променљиве окружења (OpenAI API кључ и LangSmith API кључ):
   ```bash
   export OPENAI_API_KEY=ваш_openai_api_кључ_овде
   export LANGSMITH_API_KEY=ваш_langsmith_api_кључ_овде
   export LANGSMITH_PROJECT=rag-chunking-comparison
   ```

4. Покрените Streamlit апликацију:
   ```bash
   streamlit run main/frontend_app.py
   ```

5. Отворите ваш претраживач на URL-у приказаном у терминалу (обично http://localhost:8501)

Кориснички интерфејс вам омогућава да:
- Изаберете две различите стратегије парчања текста за поређење једна поред друге
- Филтрирате по одређеним документима
- Прегледате оригинални текст документа
- Унесете упите и видите пронађене чанкове и генерисане одговоре
- Упоредите како различите стратегије парчања текста утичу на квалитет претраге

## Захтеви

- Python 3.11
- Подршка за GPU (CUDA или MPS)
- OpenAI API кључ (за генерисање одговора и евалуацију)
- Hugging Face налог (за приступ скупу података)

## Скуп података

Оквир користи [Qasper скуп података](https://allenai.org/data/qasper) од AI2, који садржи парове питања и одговора за научне радове. Скуп података се аутоматски преузима користећи Hugging Face библиотеку за скупове података.

## Структура

- `main/`: Скрипте за извршавање
- `master/src/chunkers/`: Стратегије парчања текста
- `master/src/database/`: Векторска база података
- `master/src/evaluation/`: Метрике и евалуација
- `master/src/processor/`: Обрада докумената
- `master/src/utils/`: Помоћне функције
- `data/`: Генерисани подаци (Qasper скуп података и ChromaDB фајлови)

## Прилагођавање

Измените параметре парчања текста у `main-rag_processor.py` откоментарисањем различитих опција за парчање.

## Резултати

Резултати евалуације се чувају у `data/evaluation_results/` у JSON формату, укључујући:
- Прецизност@k, Одзив@k и F1@k скорове
- MRR@k метрике и LLM судија
- Метрике по питању и укупне метрике

## Git подешавање

Када пушујете на GitHub, користите овај `.gitignore`:
```
.venv/
__pycache__/
*.py[cod]
*$py.class
.env
data/chroma_db/
```

## Лиценца

MIT Лиценца